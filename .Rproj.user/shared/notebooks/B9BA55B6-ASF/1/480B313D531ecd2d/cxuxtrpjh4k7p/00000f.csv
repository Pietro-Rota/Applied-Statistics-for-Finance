"0","###### CKLS - Parameter Estimation ######"
"0","start <- as.Date(""2020-01-24"") "
"0","end <- as.Date(""2021-10-04"")"
"0",""
"0","MSFT <- getSymbols(""MSFT"", from = start, to = end, auto.assign = FALSE)"
"0","attr(MSFT, ""src"")"
"1","[1]"
"1"," ""yahoo"""
"1","
"
"0","adj_close <- MSFT$MSFT.Adjusted"
"0","l_ret <- diff(log(adj_close))"
"0","l_ret <- na.omit(l_ret)"
"0",""
"0","#CKLS parameter estimation with MLE"
"0","ret <- setYuima(data=setData(adj_close))"
"0","ckls <- setModel(drift=""theta1-theta2*x"", diffusion=matrix(""theta3*x^theta4"",1,1),solve.variable=""x"")"
"0","startCkls <- list(theta1=.1, theta2 =.1, theta3 =.3, theta4=0.5)"
"0","lowerCkls <- list(theta1=1e-3, theta2 =1e-6, theta3 =1e-3, theta4=1e-3)"
"0","upperCkls <- list(theta1=3, theta2 =3, theta3 =3, theta4=2)"
"0",""
"0","yuima <- setYuima(data=ret@data, model=ckls)"
"0","outCkls <- qmle(yuima,  start=startCkls, lower=lowerCkls, upper=upperCkls, method=""L-BFGS-B"")"
"0",""
"0","coef(outCkls)"
"1","     theta3 "
"1","     theta4 "
"1","     theta1 "
"1","     theta2 "
"1","
"
"1","0.318447556 "
"1","0.790200336 "
"1","2.005853216 "
"1","0.008006432 "
"1","
"
"0","resultCkls <-  outCkls@coef"
"0","CKLSParam <- t(outCkls@coef)"
"0",""
"0","theta1 <- as.numeric(CKLSParam[1])"
"0","theta2 <- as.numeric(CKLSParam[2])"
"0","theta3 <- as.numeric(CKLSParam[3])"
"0","theta4 <- as.numeric(CKLSParam[4])"
"0",""
"0","theta1"
"1","[1]"
"1"," 0.3184476"
"1","
"
"0","theta2"
"1","[1]"
"1"," 0.7902003"
"1","
"
"0","theta3"
"1","[1]"
"1"," 2.005853"
"1","
"
"0","theta4"
"1","[1]"
"1"," 0.008006432"
"1","
"
"0","#### CKLS - Test Fitting ######"
"0",""
"0","#simulation"
"0","N<-length(l_ret[,1])"
"0","Delta=1/252"
"0","Time<-N*Delta"
"0","samp<-setSampling (n=N, Terminal=Time)"
"0",""
"0","MSFTsimulationCKLS <-simulate(ckls, xinit=adj_close[427,1] , sampling=samp, true.par = list(theta1=CKLSParam[3], theta2=CKLSParam[4], theta3=CKLSParam[1], theta4=CKLSParam[2]))"
"0","plot(MSFTsimulationCKLS, main = ""Merton Simulation"", xlab = ""Delta"", ylab = ""Price"")"
