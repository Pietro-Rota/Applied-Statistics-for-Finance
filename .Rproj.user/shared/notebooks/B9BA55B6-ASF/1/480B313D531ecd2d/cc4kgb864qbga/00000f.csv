"0","###### VG - Parameter Estimation ######"
"0",""
"0","##VG parameter estimation with MLE"
"0","vgFit(l_ret)    "
"1","
Data:     "
"1"," "
"1","l_ret"
"1"," "
"1","
"
"1","Parameter estimates:
"
"1","      vgC  "
"1","    sigma  "
"1","    theta  "
"1","       nu  "
"1","
"
"1","4.691e-05  "
"1","3.487e-02  "
"1","1.960e-03  "
"1","2.442e+00  "
"1","
"
"1","Likelihood:        "
"1"," "
"1","1034.368"
"1"," "
"1","
"
"1","Method:            "
"1"," "
"1","Nelder-Mead"
"1"," "
"1","
"
"1","Convergence code:  "
"1"," "
"1","0"
"1"," "
"1","
"
"1","Iterations:        "
"1"," "
"1","513"
"1"," "
"1","
"
"0","str(vgFit(l_ret))"
"1","List"
"1",""
"1"," of "
"1",""
"1","14"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","param      "
"1",""
"1",":"
"1"," Named num [1:4] "
"1",""
"1","4.69e-05 3.49e-02 1.96e-03 2.44"
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:4] "
"1",""
"1","""vgC"" ""sigma"" ""theta"" ""nu"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","maxLik     "
"1",""
"1",":"
"1"," num "
"1",""
"1","1034"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","hessian    "
"1",""
"1",":"
"1"," NULL
"
"1"," "
"1",""
"1","$ "
"1",""
"1","method     "
"1",""
"1",":"
"1"," chr "
"1",""
"1","""Nelder-Mead"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","conv       "
"1",""
"1",":"
"1"," num "
"1",""
"1","0"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","iter       "
"1",""
"1",":"
"1"," num "
"1",""
"1","513"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","obs        "
"1",""
"1",":"
"1"," num [1:426] "
"1",""
"1","-0.0169 0.0194 0.0155 0.0278 -0.0149"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","obsName    "
"1",""
"1",":"
"1"," chr "
"1",""
"1","""l_ret"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","paramStart "
"1",""
"1",":"
"1"," Named num [1:4] "
"1",""
"1","-4.1995 0.3369 0.0113 1"
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:4] "
"1",""
"1","""vgC"" ""lsigma"" ""theta"" ""lnu"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","svName     "
"1",""
"1",":"
"1"," chr "
"1",""
"1","""Skew Laplace"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","startValues"
"1",""
"1",":"
"1"," chr "
"1",""
"1","""SL"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","breaks     "
"1",""
"1",":"
"1"," num [1:8] "
"1",""
"1","-0.2 -0.15 -0.1 -0.05 0 0.05 0.1 0.15"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","midpoints  "
"1",""
"1",":"
"1"," num [1:7] "
"1",""
"1","-0.175 -0.125 -0.075 -0.025 0.025 0.075 0.125"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","empDens    "
"1",""
"1",":"
"1"," num [1:7] "
"1",""
"1","0.0469 NA 0.3286 8.6854 10.5164"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","- attr(*, ""class"")="
"1"," chr "
"1",""
"1","""vgFit"""
"1",""
"1","
"
"0","vg_param <- vgFit(l_ret)$param"
"0","vg_param"
"1","         vgC "
"1","       sigma "
"1","       theta "
"1","          nu "
"1","
"
"1","4.691426e-05 "
"1","3.487429e-02 "
"1","1.960427e-03 "
"1","2.441759e+00 "
"1","
"
"0","c <- as.numeric(vg_param[1])"
"0","sigma <- as.numeric(vg_param[2])"
"0","theta <- as.numeric(vg_param[3])"
"0","nu <- as.numeric(vg_param[4])"
"0",""
"0","###### VG - Simulation ######"
"0","#VG Process"
"0","sigma <- 0.04"
"0","theta <- 0.0006"
"0","nu <- 2.5"
"0","#Simulation of 1 path"
"0","nsim <- 10"
"0","N <- 100"
"0",""
"0","a=1/nu  "
"0","b=1/nu "
"0","h=Time/N"
"0","Time=(0:N)*Time/N"
"0","X=rep(0, N+1) #Check!X=rep(0,Time+1)"
"0","I=rep(0,N) "
"0","X[1]=0 "
"0",""
"0","VGexp_paths<-matrix(nrow = nsim, ncol=N)"
"0",""
"0","for(i in 1:nsim){"
"0","  for (j in 1:N) {"
"0","    I[j]=rgamma(1,a*h,b) "
"0","    X[j+1]=X[j] + theta*I[j]+sigma*sqrt(I[j])*rnorm(1)#*exp((r-q)*h) ###Here I added the dividend yield q"
"0","    VGexp_paths[i,j]<-X[j+1]"
"0","  }"
"0","}"
"0","VGexp_paths<-cbind((matrix(0, nrow=nsim, ncol=1)),VGexp_paths)"
"0","VGexp_paths %>% round(3) %>% datatable()"
