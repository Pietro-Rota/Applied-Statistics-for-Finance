"0","# MEIXNER MODEL"
"0","#Moments: mean, variance, skewness, kurtosis"
"0","x <-mean(l_ret, na.rm = TRUE)"
"0","y <-sd(l_ret, na.rm = TRUE)"
"0","z <-as.numeric(skewness(l_ret, na.rm = TRUE))"
"0","w <-as.numeric(kurtosis(l_ret, na.rm = TRUE))"
"0","#Mom: estimates parameters m, a, b, d as functions of the moments"
"0","m <- x-((z*sqrt(y))/(w-(z^2)-3))"
"0","a <- sqrt(y*(2*w-3*(z^2)-6))"
"0","b <- 2*atan(-sqrt((z^2)/(2*w-3*(z^2)-6)))"
"0","d <- 1/(w-(z^2)-3)"
"0",""
"0","#risk neutral transformation"
"0","#Esscher transform: Meixner(a, a*theta + b, d, m) distribution"
"0",""
"0","#theta <- -1/a * (b + 2 * atan((-cos(a/2)+ exp((m-r)/2*d))/sin(a/2)))"
"0","#b <- a*theta+b"
"0",""
"0","#mean correction"
"0",""
"0","#m <- r -2 *d*log(cos(b/2)/cos((a+b)/2))"
"0",""
"0","#Meixner function"
"0","MX=function(a, b, d, m, N) {"
"0","  distr <- udmeixner(a, b, d, m) #meixner distribution"
"0","  gen <- pinvd.new(distr) #Polynomial interpolation of INVerse CDF"
"0","  rdmMXgen <- ur(gen,N) #randomly draws N objects from gen (from a Meixner distr)"
"0","  h=Time/N"
"0","  X=rep(0,N+1)"
"0","  for (i in 1:N){"
"0","    X[i+1]=X[1]+rdmMXgen[i]"
"0","  }"
"0","  return(X)"
"0","}"
"0",""
"0","MX(a, b, d, m, N)"
"1","  [1]"
"1","  0.0000000000"
"1","  0.0254657044"
"1"," -0.0466717931"
"1"," -0.2041653956"
"1"," -0.0005509245"
"1"," -0.0592518036"
"1"," -0.0331397885"
"1","
"
"1","  [8]"
"1"," -0.0596564203"
"1","  0.0727160944"
"1","  0.1827362249"
"1","  0.1168985520"
"1","  0.3285298353"
"1","  0.0474648165"
"1","  0.4602331943"
"1","
"
"1"," [15]"
"1"," -0.0903450367"
"1","  0.1186285581"
"1"," -0.1259283492"
"1","  0.0972367469"
"1","  0.0995445975"
"1"," -0.0838397224"
"1"," -0.0488095299"
"1","
"
"1"," [22]"
"1"," -0.0168765567"
"1","  0.0777369358"
"1","  0.1303831846"
"1"," -0.0392827943"
"1","  0.0636652672"
"1","  0.0620523555"
"1"," -0.0460813491"
"1","
"
"1"," [29]"
"1"," -0.2693303596"
"1","  0.1025405066"
"1","  0.1854177925"
"1","  0.0185900858"
"1"," -0.0209754175"
"1"," -0.0326246587"
"1"," -0.2418640198"
"1","
"
"1"," [36]"
"1","  0.1202191010"
"1","  0.0868903435"
"1"," -0.1976075043"
"1"," -0.1863211983"
"1","  0.1499615348"
"1","  0.1298229654"
"1"," -0.0915988679"
"1","
"
"1"," [43]"
"1","  0.1142528228"
"1","  0.2606002504"
"1","  0.0906413872"
"1"," -0.0335961462"
"1"," -0.1499984700"
"1"," -0.2324654443"
"1","  0.0038527397"
"1","
"
"1"," [50]"
"1","  0.0173077855"
"1"," -0.0035223347"
"1"," -0.1364478993"
"1","  0.0065812261"
"1"," -0.1160926197"
"1"," -0.0293907578"
"1","  0.0369612650"
"1","
"
"1"," [57]"
"1"," -0.1050845488"
"1"," -0.1163235167"
"1","  0.0058867206"
"1"," -0.0244548701"
"1","  0.1698242711"
"1"," -0.0438226558"
"1","  0.0507309382"
"1","
"
"1"," [64]"
"1","  0.1564055259"
"1"," -0.0065375971"
"1","  0.0941614931"
"1","  0.0757223994"
"1"," -0.1146547831"
"1","  0.1180513475"
"1"," -0.0547428196"
"1","
"
"1"," [71]"
"1","  0.1653770910"
"1","  0.0929713958"
"1"," -0.1495735597"
"1"," -0.1174413620"
"1","  0.1020480604"
"1","  0.1410311526"
"1","  0.0719522771"
"1","
"
"1"," [78]"
"1","  0.0648486777"
"1","  0.2851156222"
"1"," -0.0618820570"
"1"," -0.0536559162"
"1","  0.0874744434"
"1"," -0.0206285981"
"1","  0.0753656833"
"1","
"
"1"," [85]"
"1"," -0.0177110469"
"1"," -0.2314137051"
"1","  0.1449772830"
"1","  0.0765419533"
"1","  0.1944387048"
"1","  0.3334595823"
"1","  0.0944544002"
"1","
"
"1"," [92]"
"1"," -0.0790195773"
"1"," -0.1660379125"
"1","  0.1742479222"
"1","  0.0305494312"
"1"," -0.0257873081"
"1"," -0.0121130990"
"1"," -0.0998377293"
"1","
"
"1"," [99]"
"1"," -0.3656774355"
"1","  0.1531579889"
"1","  0.0607997529"
"1","
"
"0","MX_paths<-matrix(nrow = nsim, ncol=N+1) #fill the matrix with random paths that follow"
"0","for(i in 1:nsim){                        #the function MX just created"
"0","  MX_paths[i,]<-MX(a,b,d,m,N)"
"0","}"
"0",""
"0","MX_paths %>% t() %>% format(x = , scientific = TRUE, digits = 3) %>% datatable()"
