"0","GBM.vec <- function(N = 100, x = 10, r = 1, sigma = 0.5, Time = 1) {"
"0","  # r = 1"
"0","  # sigma = 0.5"
"0","  # x = 10"
"0","  # N = 100                  # number of grid points including maturity Time"
"0","  # Time = 1                 # length of the interval [0, Time] in time units"
"0","  "
"0","  Delta <- Time/(N+1)        # time increment (dt)"
"0","  W <- numeric(N)            # initialization of the vector W"
"0","  "
"0","  Time <- seq(0, Time, length=N)"
"0","  for(i in 2:N)"
"0","           W[i] <- W[i-1] + rnorm(1) * sqrt(Delta)"
"0","  "
"0","  S <- x * exp((r-sigma^2/2)*Time + sigma*W)"
"0","  return(S)"
"0","}"
"0",""
"0","MNC_Sim <- replicate(100, GBM.vec(sigma = 0.8))"
"0","MNC_Sim %>% quickplot(""Montecarlo simulation of geometric brownian motion"",show_legend = F, x_size = 100)+"
"0","  geom_hline(aes(yintercept = 30), linewidth = 2, color = ""red"")"
