"0","#CEV parameter estimation with QMLE"
"0",""
"0","Delta<-1/252 "
"0",""
"0","ret <- setYuima(data=setData(adj_close))"
"0","dat <- as.vector(coredata(ret@data@original.data))"
"0","a.hat <- var(diff(log(dat)))/Delta"
"0","b.hat <- mean(diff(log(dat)))/Delta + 0.5*a.hat"
"0","cev <- setModel(drift=""mu*x"", diffusion=""sigma*x^gamma"", solve.variable=""x"")"
"0","yuimaCEv <- setYuima(model=cev, data=ret@data)"
"0",""
"0","lowerCev <- list(mu=0.00001, sigma=0.001,gamma=0.000)"
"0","upperCev <- list(mu=2, sigma=2,gamma=2)"
"0","startCev <- list(mu=b.hat, sigma=a.hat, gamma=1)"
"0",""
"0","outCev <- qmle(yuimaCEv, start=startCev, upper=upperCev, lower=lowerCev, method=""L-BFGS-B"")"
"0",""
"0","summary(outCev)"
"1","Quasi-Maximum likelihood estimation

Call:
"
"1","qmle(yuima = yuimaCEv, start = startCev, method = ""L-BFGS-B"", 
"
"1","    lower = lowerCev, upper = upperCev)
"
"1","
Coefficients:
"
"1","     "
"1","    Estimate"
"1"," Std. Error"
"1","
sigma"
"1"," 0.376938494"
"1","        NaN"
"1","
gamma"
"1"," 1.014312000"
"1"," 0.11779185"
"1","
mu   "
"1"," 0.001628185"
"1"," 0.01971748"
"1","
"
"1","
-2 log L:"
"1"," "
"1","4581.359"
"1"," "
"1","
"
"0","resultCev <- outCev@coef"
"0","CEVParam <- t(outCev@coef)"
"0",""
"0","sigma <- as.numeric(CEVParam[1])"
"0","gamma <- as.numeric(CEVParam[2])"
"0","mu <- as.numeric(CEVParam[3])"
"0",""
"0","###### CEV - Simulation ######"
"0","CEV_paths <- matrix(nrow = nsim, ncol = N+1)"
"0","samp <- setSampling (n=N, Terminal=Time)"
"0",""
"0","for (i in 1:nsim) {"
"0","  MSFTsimulationCEV <-simulate(cev, xinit=adj_close[427,1] , sampling=samp, true.par = list(mu=CEVParam[3], sigma=CEVParam[1], gamma=CEVParam[2]))"
"0","  CEV_paths[i,] <-  MSFTsimulationCEV@data@original.data"
"0","}"
"0",""
"0","colori=viridis(nsim)"
"0","plot(CEV_paths[1,], col=0, type=""l"", ylim = c(min(CEV_paths),max(CEV_paths)), "
"0","     main = ""Monte Carlo Simulation for CEV returns"", sub = ""10 steps, 10 paths"", "
"0","     xlab = ""Time"", ylab = ""CEV returns"")"
