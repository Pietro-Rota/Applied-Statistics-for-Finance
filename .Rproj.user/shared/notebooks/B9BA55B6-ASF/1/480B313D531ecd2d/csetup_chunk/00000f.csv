"0","# library(quantmod)"
"0","# library(ggplot2)"
"0","# library(magrittr)"
"0","library(broom)"
"0","# library(dplyr)"
"0","# library(plotly)"
"0","library(hrbrthemes)"
"0","library(""viridis"")"
"0","# library(sde)"
"0","library(tseries)"
"0","library(Runuran)"
"0","library(moments)"
"0","library(fBasics)"
"0","library(""stats4"")"
"0","library(yuima)"
"0","library(VarianceGamma)"
"0","library(ghyp)"
"0","library(GeneralizedHyperbolic)"
"0","library(EnvStats)"
"0","library(Sim.DiffProc)"
"0","source(""C:/Users/pietr/OneDrive/Desktop/formula.main.R"")"
"0","knitr::opts_chunk$set(error=TRUE)"
"0","knitr::opts_chunk$set(warning = FALSE)"
"0","Sys.setlocale(""LC_TIME"", ""English"") # set output language in English"
"1","[1]"
"1"," ""English_United States.1252"""
"1","
"
"0","knitr::opts_chunk$set(fig.align = 'center')"
"0","knitr::opts_chunk$set(tidy=TRUE)"
"0","library(microbenchmark)"
"0",""
"0",""
"0","gghistogram <- function (x, add.normal = FALSE, add.kde = FALSE, add.rug = FALSE, bins, boundary = 0, "
"0","                         fill = ""#1f77b4"") "
"0","{"
"0","    if (!requireNamespace(""ggplot2"", quietly = TRUE)) {"
"0","        stop(""ggplot2 is needed for this function to work. Install it via install.packages(\""ggplot2\"")"", "
"0","            call. = FALSE)"
"0","    }"
"0","    else {"
"0","        if (missing(bins)) {"
"0","            bins <- min(500, grDevices::nclass.FD(na.exclude(x)))"
"0","        }"
"0","        data <- data.frame(x = as.numeric(c(x)))"
"0","        binwidth <- (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))/bins"
"0","        p <- ggplot2::ggplot() + ggplot2::geom_histogram(ggplot2::aes(x), "
"0","            data = data, binwidth = binwidth, boundary = boundary, fill = fill) + "
"0","            ggplot2::xlab(deparse(substitute(x)))"
"0","        if (add.normal || add.kde) {"
"0","            xmin <- min(x, na.rm = TRUE)"
"0","            xmax <- max(x, na.rm = TRUE)"
"0","            if (add.kde) {"
"0","                h <- stats::bw.SJ(x)"
"0","                xmin <- xmin - 3 * h"
"0","                xmax <- xmax + 3 * h"
"0","            }"
"0","            if (add.normal) {"
"0","                xmean <- mean(x, na.rm = TRUE)"
"0","                xsd <- sd(x, na.rm = TRUE)"
"0","                xmin <- min(xmin, xmean - 3 * xsd)"
"0","                xmax <- max(xmax, xmean + 3 * xsd)"
"0","            }"
"0","            xgrid <- seq(xmin, xmax, length.out = 512)"
"0","            if (add.normal) {"
"0","                df <- data.frame(x = xgrid, y = length(x) * binwidth * "
"0","                  stats::dnorm(xgrid, xmean, xsd))"
"0","                p <- p + ggplot2::geom_line(ggplot2::aes(df$x, "
"0","                  df$y), col = ""#ff8a62"")"
"0","            }"
"0","            if (add.kde) {"
"0","                kde <- stats::density(x, bw = h, from = xgrid[1], "
"0","                  to = xgrid[512], n = 512)"
"0","                p <- p + ggplot2::geom_line(ggplot2::aes(x = kde$x, "
"0","                  y = length(x) * binwidth * kde$y), col = ""#67a9ff"")"
"0","            }"
"0","        }"
"0","        if (add.rug) {"
"0","            p <- p + ggplot2::geom_rug(ggplot2::aes(x))"
"0","        }"
"0","        return(p)"
"0","    }"
"0","}"
