"0","# #FROM MEIXNER RETURNS TO STOCK PRICES"
"0","# "
"0","# #function for stock price with Meixner returns"
"0","# MXexp=function(a, b, d, m, N, Time, r, S0) {"
"0","#   distr <- udmeixner(a, b, d, m) #meiner distribution"
"0","#   gen <- pinvd.new(distr) #Polynomial interpolation of INVerse CDF"
"0","#   generazioni <- ur(gen,N) #randomly draws N objects from gen (from a Meixner distr)"
"0","#   h=Time/N"
"0","#   Time=(0:N)*Time/N"
"0","#   X=rep(0,N+1)"
"0","#   X[1]=S0"
"0","#   for (i in 1:N){"
"0","#     X[i+1]=X[1]*exp(r*Time+generazioni[i])"
"0","#   }"
"0","#   return(X)"
"0","# }"
"0","# "
"0","# MXexp(a, b, d, m, N, Time, r, S0)"
"0","# "
"0","# MXexp_paths<-matrix(nrow = nsim, ncol=N+1)"
"0","# for(i in 1:nsim){"
"0","#   MXexp_paths[i,]<-MXexp(a,b,d,m,100,Time,r,S0) #vengono tutte le linee uguali perchÃ© MX non varia!"
"0","# }"
"0","# "
"0","# MXexp_paths %>% t() %>% round(2) %>% datatable()"
"0","# "
"0","# #statistics on final prices"
"0","# final_pricesMX<-MXexp_paths[,N+1]"
"0","# "
"0","# #risk neutral transform"
"0","# rn_final_pricesMX<-S0*(final_pricesMX)*(exp(r*Time)/(mean(final_pricesMX)))"
"0","# rn_final_pricesMX %>% t() %>% datatable()"
"0","# "
"0","# basicStats(rn_final_pricesMX)"
"0","# hist(rn_final_pricesMX)"
"0","# "
"0","# ########payoff if you use the Esscher transform or the first mean correcting martingale"
"0","# "
"0","# #payoff_MX <- pmax(final_pricesMX - K, 0)"
"0","# "
"0","# #optprice_MX <- mean(payoff_MX)*exp(-r*Time)"
"0","# "
"0","# #optprice_MX"
"0","# "
"0","# #########payoff if you mean correct of the simulated paths"
"0","# "
"0","# payoff_MX <- pmax(rn_final_pricesMX - K, 0)"
"0","# "
"0","# optprice_MX <- mean(payoff_MX)*exp(-r*Time)"
"0","# "
"0","# optprice_MX"
