"0","# CALL formula"
"0","call.price <- function(x = 1, Time = 0, T_mat = 1, r = 1, sigma = 1, K = 1) {"
"0","  d2 <- (log(x / K) + (r - 0.5 * sigma^2) * (T_mat - Time)) / (sigma * sqrt(T_mat - Time))"
"0","  d1 <- d2 + sigma * sqrt(T_mat - Time)"
"0","  price <- x * pnorm(d1) - K * exp(-r * (T_mat - Time)) * pnorm(d2)"
"0","  return(price)"
"0","}"
"0",""
"0","# PUT formula"
"0","put.price <- function(x = 1, Time = 0, T_mat = 1, r = 1, sigma = 1, K = 1) {"
"0","  d2 <- (log(x / K) + (r - 0.5 * sigma^2) * (T_mat - Time)) / (sigma * sqrt(T_mat - Time))"
"0","  d1 <- d2 + sigma * sqrt(T_mat - Time)"
"0","  price <- K * exp(-r * (T_mat - Time)) * pnorm(-d2) - x * pnorm(-d1)"
"0","  return(price)"
"0","}"
"0",""
"0","# Example"
"0","S0 <- 100"
"0","K <- 110"
"0","r <- 0.05"
"0","Time <- 1/4"
"0","sigma <- 0.25"
"0","C <- call.price(x = S0, Time = 0, T_mat = Time, r = r, K = K, sigma = sigma)"
"0","cat(""Call price according to Black and Scholes"", C, ""\n"")"
"1","Call price according to Black and Scholes"
"1"," "
"1","1.980506"
"1"," "
"1","
"
"0","P <- put.price(x = S0, Time = 0, T_mat = Time, r = r, K = K, sigma = sigma)"
"0","cat(""Put price according to Black and Scholes"", P, ""\n"")"
"1","Put price according to Black and Scholes"
"1"," "
"1","10.61406"
"1"," "
"1","
"
"0","# Put-Call parity"
"0","P2 <- C - S0 + K * exp(-r * Time)"
"0","cat(""Put price according to Put call parity"", P2, ""\n"")"
"1","Put price according to Put call parity"
"1"," "
"1","10.61406"
"1"," "
"1","
"
