"0","###### VG - Parameter Estimation ######"
"0","start <- as.Date(""2020-01-24"") "
"0","end <- as.Date(""2021-10-04"")"
"0",""
"0","MSFT <- getSymbols(""MSFT"", from = start, to = end, auto.assign = FALSE)"
"0","attr(MSFT, ""src"")"
"1","[1]"
"1"," ""yahoo"""
"1","
"
"0","adj_close <- MSFT$MSFT.Adjusted"
"0","l_ret <- diff(log(adj_close))"
"0","l_ret <- na.omit(l_ret)"
"0",""
"0","#VG parameter estimation with MLE"
"0",""
"0","vgFit(l_ret)    "
"1","
Data:     "
"1"," "
"1","l_ret"
"1"," "
"1","
"
"1","Parameter estimates:
"
"1","      vgC  "
"1","    sigma  "
"1","    theta  "
"1","       nu  "
"1","
"
"1","0.0000468  "
"1","0.0346896  "
"1","0.0005911  "
"1","2.4822300  "
"1","
"
"1","Likelihood:        "
"1"," "
"1","1034.098"
"1"," "
"1","
"
"1","Method:            "
"1"," "
"1","Nelder-Mead"
"1"," "
"1","
"
"1","Convergence code:  "
"1"," "
"1","0"
"1"," "
"1","
"
"1","Iterations:        "
"1"," "
"1","445"
"1"," "
"1","
"
"0","str(vgFit(l_ret))"
"1","List"
"1",""
"1"," of "
"1",""
"1","14"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","param      "
"1",""
"1",":"
"1"," Named num [1:4] "
"1",""
"1","4.68e-05 3.47e-02 5.91e-04 2.48"
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:4] "
"1",""
"1","""vgC"" ""sigma"" ""theta"" ""nu"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","maxLik     "
"1",""
"1",":"
"1"," num "
"1",""
"1","1034"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","hessian    "
"1",""
"1",":"
"1"," NULL
"
"1"," "
"1",""
"1","$ "
"1",""
"1","method     "
"1",""
"1",":"
"1"," chr "
"1",""
"1","""Nelder-Mead"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","conv       "
"1",""
"1",":"
"1"," num "
"1",""
"1","0"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","iter       "
"1",""
"1",":"
"1"," num "
"1",""
"1","445"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","obs        "
"1",""
"1",":"
"1"," num [1:426] "
"1",""
"1","-0.0169 0.0194 0.0155 0.0278 -0.0149"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","obsName    "
"1",""
"1",":"
"1"," chr "
"1",""
"1","""l_ret"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","paramStart "
"1",""
"1",":"
"1"," Named num [1:4] "
"1",""
"1","-4.1999 0.3368 0.0113 1"
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:4] "
"1",""
"1","""vgC"" ""lsigma"" ""theta"" ""lnu"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","svName     "
"1",""
"1",":"
"1"," chr "
"1",""
"1","""Skew Laplace"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","startValues"
"1",""
"1",":"
"1"," chr "
"1",""
"1","""SL"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","breaks     "
"1",""
"1",":"
"1"," num [1:8] "
"1",""
"1","-0.2 -0.15 -0.1 -0.05 0 0.05 0.1 0.15"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","midpoints  "
"1",""
"1",":"
"1"," num [1:7] "
"1",""
"1","-0.175 -0.125 -0.075 -0.025 0.025 0.075 0.125"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","empDens    "
"1",""
"1",":"
"1"," num [1:7] "
"1",""
"1","0.0469 NA 0.3286 8.6854 10.5164"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","- attr(*, ""class"")="
"1"," chr "
"1",""
"1","""vgFit"""
"1",""
"1","
"
"0","#vgFit(l_ret, method = ""BFGS"")"
"0","#vgFit(l_ret, method = ""nlm"")"
"0","vg_param <- vgFit(l_ret)$param"
"0","vg_param"
"1","         vgC "
"1","       sigma "
"1","       theta "
"1","          nu "
"1","
"
"1","4.680161e-05 "
"1","3.468964e-02 "
"1","5.911448e-04 "
"1","2.482230e+00 "
"1","
"
"0","c <- as.numeric(vg_param[1])"
"0","sigma <- as.numeric(vg_param[2])"
"0","theta <- as.numeric(vg_param[3])"
"0","nu <- as.numeric(vg_param[4])"
"0",""
"0","sigma"
"1","[1]"
"1"," 0.03468964"
"1","
"
"0","theta"
"1","[1]"
"1"," 0.0005911448"
"1","
"
"0","nu"
"1","[1]"
"1"," 2.48223"
"1","
"
"0","###### VG - Test Fitting ######"
"0",""
"0","##QQ Plot VGfit"
"0","l_ret.s <- sort(as.numeric(l_ret)) "
"0","p <- ppoints(length(l_ret.s))"
"0","VG.q <- qvg(p, vgC=c, sigma=sigma, theta=theta, nu=nu) "
"0","plot(VG.q, l_ret.s, main = ""MSFT Variance-Gamma Q-Q Plot"","
"0","     xlab = ""Theoretical Quantiles"", ylab = ""Sample Quantiles"")"
