"0","#FROM VARIANCE-GAMMA RETURNS TO STOCK PRICES"
"0","r <- 0.01"
"0","S0 <- as.numeric(tail(S, n=1)) #prezzo inziale"
"0","S0"
"1","[1]"
"1"," 289.1"
"1","
"
"0","# function for stock price with VG returns"
"0","VGexp <- function(sigma, nu, theta, Time, N, r, S0) {"
"0","  a <- 1 / nu"
"0","  b <- 1 / nu"
"0","  h <- Time / N"
"0","  Time <- (0:N) * Time / N"
"0","  X <- rep(0, N + 1)"
"0","  I <- rep(0, N)"
"0","  X[1] <- S0"
"0","  for (i in 1:N) {"
"0","    I[i] <- rgamma(1, a * h, b) # gamma component for the jump"
"0","    X[i + 1] <- X[i] * exp(r * Time + theta * I[i] + sigma * sqrt(I[i]) * rnorm(1))"
"0","  }"
"0","  return(X)"
"0","}"
"0",""
"0","VGexp_paths <- matrix(nrow = nsim, ncol = N + 1)"
"0","for (i in 1:nsim) {"
"0","  VGexp_paths[i, ] <- VGexp(sigma, nu, theta, Time, N, r, S0)"
"0","}"
