"0","###### MERTON - Parameter Estimation ######"
"0","start <- as.Date(""2020-01-24"") "
"0","end <- as.Date(""2021-10-04"")"
"0",""
"0","MSFT <- getSymbols(""MSFT"", from = start, to = end, auto.assign = FALSE)"
"0","attr(MSFT, ""src"")"
"1","[1]"
"1"," ""yahoo"""
"1","
"
"0","adj_close <- MSFT$MSFT.Adjusted"
"0","l_ret <- diff(log(adj_close))"
"0","l_ret <- na.omit(l_ret)"
"0",""
"0","#MERTON parameter estimation with MLE"
"0",""
"0","Delta<-1/252 "
"0",""
"0","ret <- setYuima(data=setData(adj_close))"
"0","dat <- as.vector(coredata(ret@data@original.data))"
"0","a.hat <- var(diff(log(dat)))/Delta"
"0","a.hat <- var(diff(log(dat)))/Delta"
"0","b.hat <- mean(diff(log(dat)))/Delta + 0.5*a.hat"
"0","mer <- setModel(drift=""mu*x"",diffusion=""sigma*x"",jump.coeff=""1"", measure=list(intensity=""lambda"", df=list(""dnorm(z, beta, dels )"")),measure.type=""CP"", solve.variable=""x"")"
"0","yuimaMer <- setYuima(model=mer, data=ret@data)"
"0",""
"0","lower<-list(mu=0.00001, sigma=0.01, lambda=0.001, beta=0.0001, dels =0.1)"
"0","upper<-list(mu=1, sigma=100,lambda=25, beta=50, dels =50)"
"0","start<-list(mu=b.hat, sigma=a.hat, lambda=5, beta=1, dels =2)"
"0",""
"0","outMer <- qmle (yuimaMer, start=start, upper=upper, lower=lower, threshold = 2.5, method=""L-BFGS-B"")"
"0",""
"0","summary(outMer)"
"1","Quasi-Maximum likelihood estimation

Call:
"
"1","qmle(yuima = yuimaMer, start = start, method = ""L-BFGS-B"", lower = lower, 
"
"1","    upper = upper, threshold = 2.5)
"
"1","
Coefficients:
"
"1","      "
"1","     Estimate"
"1"," Std. Error"
"1","
sigma "
"1"," 0.4076784875"
"1","        NaN"
"1","
mu    "
"1"," 0.0003179241"
"1"," 0.02659401"
"1","
lambda"
"1"," 0.3100683566"
"1"," 0.02243553"
"1","
beta  "
"1"," 0.6007442814"
"1"," 0.42706430"
"1","
dels  "
"1"," 5.9021459883"
"1"," 0.30198063"
"1","
"
"1","
-2 log L:"
"1"," "
"1","4588.749"
"1"," "
"1","
"
"1","

Number of estimated jumps: 192
"
"1","
Average inter-arrival times: 3.225131
"
"1","
Average jump size: 0.600718
"
"1","
Standard Dev. of jump size: 5.917650
"
"1","
Jump Threshold: 2.500000
"
"1","
Summary statistics for jump times:
"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","
"
"1","  18285 "
"1","  18412 "
"1","  18555 "
"1","  18570 "
"1","  18717 "
"1","  18901 "
"1","
"
"1","
Summary statistics for jump size:
"
"1","    Min. "
"1"," 1st Qu. "
"1","  Median "
"1","    Mean "
"1"," 3rd Qu. "
"1","    Max. "
"1","
"
"1","-22.4075 "
"1"," -4.0607 "
"1","  2.9463 "
"1","  0.6007 "
"1","  4.5926 "
"1"," 18.9234 "
"1","
"
"1","
"
"0","resultCev <- outMer@coef"
"0","MertonParam <- t(outMer@coef)"
"0","MertonParam"
"1","    "
"1","     sigma"
"1","           mu"
"1","    lambda"
"1","      beta"
"1","     dels"
"1","
[1,]"
"1"," 0.4076785"
"1"," 0.0003179241"
"1"," 0.3100684"
"1"," 0.6007443"
"1"," 5.902146"
"1","
"
"0","sigma <- as.numeric(MertonParam[1])"
"0","mu <- as.numeric(MertonParam[2])"
"0","lambda <- as.numeric(MertonParam[3])"
"0","beta <- as.numeric(MertonParam[4])"
"0","dels <- as.numeric(MertonParam[5])"
"0",""
"0","maxLik<-t(outMer@min)"
"0","maxLik"
"1","    "
"1","     [,1]"
"1","
[1,]"
"1"," 2294.374"
"1","
"
"0","###### MERTON - Test Fitting ######"
"0",""
"0","#simulation"
"0","N<-length(l_ret[,1])"
"0","Delta=1/252"
"0","Time<-N*Delta"
"0","samp<-setSampling (n=N, Terminal=Time)"
"0",""
"0","MSFTsimulationMerton <-simulate(mer, xinit=adj_close[427,1] , sampling=samp, true.par = list(mu=MertonParam[2], sigma=MertonParam[1], lambda=MertonParam[3], beta=MertonParam[4], dels=MertonParam[5]))"
"0","plot(MSFTsimulationMerton, main = ""Merton Simulation"", xlab = ""Delta"", ylab = ""Price"")"
