"0","###### CIR - Parameter Estimation ######"
"0","start <- as.Date(""2020-01-24"") "
"0","end <- as.Date(""2021-10-04"")"
"0",""
"0","MSFT <- getSymbols(""MSFT"", from = start, to = end, auto.assign = FALSE)"
"0","attr(MSFT, ""src"")"
"1","[1]"
"1"," ""yahoo"""
"1","
"
"0","adj_close <- MSFT$MSFT.Adjusted"
"0","l_ret <- diff(log(adj_close))"
"0","l_ret <- na.omit(l_ret)"
"0",""
"0","#CIR parameter estimation with QMLE"
"0","ret <- setYuima(data=setData(adj_close))"
"0","CIR <- setModel(drift=""theta1-theta2*x"", diffusion=matrix(""theta3*x^(1/2)"",1,1),solve.variable=""x"")"
"0","startCIR <- list(theta1=1, theta2 =.1, theta3 =.3)"
"0","lowerCIR <- list(theta1=1e-6, theta2 =1e-6, theta3 =1e-6)"
"0","upperCIR <- list(theta1=10, theta2 =10, theta3 =10)"
"0","  "
"0","yuima <- setYuima(data=ret@data, model=CIR)"
"0","outCIR <- qmle(yuima,  start=startCIR, lower=lowerCIR, upper=upperCIR, method=""L-BFGS-B"")"
"0","coef(outCIR)"
"1","     theta3 "
"1","     theta1 "
"1","     theta2 "
"1","
"
"1","1.451089792 "
"1","1.695442124 "
"1","0.006527082 "
"1","
"
"0","resultCIR <- outCIR@coef"
"0","CIRParam <- t(outCIR@coef)"
"0",""
"0","theta1 <- as.numeric(CIRParam[1])"
"0","theta2 <- as.numeric(CIRParam[2])"
"0","theta3 <- as.numeric(CIRParam[3])"
"0",""
"0","theta1"
"1","[1]"
"1"," 1.45109"
"1","
"
"0","theta2"
"1","[1]"
"1"," 1.695442"
"1","
"
"0","theta3"
"1","[1]"
"1"," 0.006527082"
"1","
"
"0","#### CIR - Test Fitting ######"
"0",""
"0","#simulation"
"0","N<-length(l_ret[,1])"
"0","Delta=1/252"
"0","Time<-N*Delta"
"0","samp<-setSampling (n=N, Terminal=Time)"
"0",""
"0","MSFTsimulationCIR <-simulate(CIR, xinit=adj_close[427,1] , sampling=samp, true.par = list(theta1=CIRParam[2], theta2=CIRParam[3], theta3=CIRParam[1]))"
"0","plot(MSFTsimulationCIR, main = ""Merton Simulation"", xlab = ""Delta"", ylab = ""Price"")"
